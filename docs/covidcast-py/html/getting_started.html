
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Getting Started &#8212; COVIDcast API client 0.1.4 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Fetching Data" href="signals.html" />
    <link rel="prev" title="COVIDcast API client" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="getting-started">
<span id="id1"></span><h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This package provides access to data from the <a class="reference external" href="https://cmu-delphi.github.io/delphi-epidata/api/covidcast.html">COVIDcast API</a>, which
provides numerous COVID-related data streams, updated daily. The data is retrieved
live from the server when you make a request, and is not stored within the package
itself. This means that each time you make a request, you will be receiving the latest
data available. If you are conducting an analysis or powering a service which will require
repeated access to the same signal, please download the data rather than making repeated
requests.</p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>This package is available on PyPI as <a class="reference external" href="https://pypi.org/project/covidcast/">covidcast</a>, and can be installed using <code class="docutils literal notranslate"><span class="pre">pip</span></code> or
your favorite Python package manager:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pip install covidcast
</pre></div>
</div>
<p>This will install the package as well as all required dependencies.</p>
</div>
<div class="section" id="signal-overview">
<h2>Signal Overview<a class="headerlink" href="#signal-overview" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://cmu-delphi.github.io/delphi-epidata/api/covidcast_signals.html">API documentation</a> lists
the available signals, including many not shown on the
<a class="reference external" href="https://covidcast.cmu.edu/">COVIDcast interactive map</a>.</p>
<p>The data come from a variety of sources and cover information including official case counts,
internet search trends, hospital encounters, survey responses, and more. Below is
a brief overview of each source, with links to their full descriptions.</p>
<ul class="simple">
<li><dl class="simple">
<dt><a class="reference external" href="https://cmu-delphi.github.io/delphi-epidata/api/covidcast-signals/chng.html">Change Healthcare</a></dt><dd><ul>
<li><p>Outpatient visits with COVID diagnostic codes, based on de-identified
medical claims data.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference external" href="https://cmu-delphi.github.io/delphi-epidata/api/covidcast-signals/doctor-visits.html">Doctor Visits</a></dt><dd><ul>
<li><p>Outpatient visits with COVID-related symptoms.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference external" href="https://cmu-delphi.github.io/delphi-epidata/api/covidcast-signals/ght.html">Google Health Trends</a></dt><dd><ul>
<li><p>COVID-related Google search volume.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference external" href="https://cmu-delphi.github.io/delphi-epidata/api/covidcast-signals/hospital-admissions.html">Hospital Admissions</a></dt><dd><ul>
<li><p>Hospital admissions with COVID-associated diagnoses.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference external" href="https://cmu-delphi.github.io/delphi-epidata/api/covidcast-signals/indicator-combination.html">Indicator Combination</a></dt><dd><ul>
<li><p>Aggregated signal of other sources to provide a single COVID activity indicator.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference external" href="https://cmu-delphi.github.io/delphi-epidata/api/covidcast-signals/jhu-csse.html">JHU Cases and Deaths</a></dt><dd><ul>
<li><p>Confirmed COVID cases and deaths based on reports made available by Johns Hopkins University.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference external" href="https://cmu-delphi.github.io/delphi-epidata/api/covidcast-signals/quidel.html">Quidel</a></dt><dd><ul>
<li><p>Positive COVID antigen tests.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference external" href="https://cmu-delphi.github.io/delphi-epidata/api/covidcast-signals/safegraph.html">SafeGraph Mobility</a></dt><dd><ul>
<li><p>Mobility (movement) data based on phone location data</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference external" href="https://cmu-delphi.github.io/delphi-epidata/api/covidcast-signals/fb-survey.html">Symptom Surveys</a></dt><dd><ul>
<li><p>Various responses to the CMU symptom survey.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference external" href="https://cmu-delphi.github.io/delphi-epidata/api/covidcast-signals/usa-facts.html">USAFacts Cases and Deaths</a></dt><dd><ul>
<li><p>Confirmed COVID cases and deaths based on reports made available by USAFacts.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>To specify a signal, you will need the “Source Name” and “Signal” value, which are
listed for each source/signal combination on their respective page.
For example, to obtain the raw Google search volume for COVID-related topics,
the source would be <code class="docutils literal notranslate"><span class="pre">ght</span></code> and the signal would be <code class="docutils literal notranslate"><span class="pre">raw_search</span></code>, as shown on the
<a class="reference external" href="https://cmu-delphi.github.io/delphi-epidata/api/covidcast-signals/ght.html">Google Health Trends page</a>.
These values will be provided as the arguments for the <a class="reference internal" href="signals.html#covidcast.signal" title="covidcast.signal"><code class="xref py py-func docutils literal notranslate"><span class="pre">covidcast.signal()</span></code></a> function to
retrieve the desired data.</p>
</div>
<div class="section" id="basic-examples">
<h2>Basic examples<a class="headerlink" href="#basic-examples" title="Permalink to this headline">¶</a></h2>
<p>To obtain smoothed estimates of COVID-like illness from our symptom survey,
distributed through Facebook, for every county in the United States between
2020-05-01 and 2020-05-07:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">covidcast</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">covidcast</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="s2">&quot;fb-survey&quot;</span><span class="p">,</span> <span class="s2">&quot;smoothed_cli&quot;</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
<span class="gp">... </span>                        <span class="s2">&quot;county&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">   geo_value      issue  lag  sample_size    stderr time_value     value</span>
<span class="go">0      01000 2020-05-23   22    1722.4551  0.125573 2020-05-01  0.823080</span>
<span class="go">1      01001 2020-05-23   22     115.8025  0.800444 2020-05-01  1.261261</span>
<span class="go">2      01003 2020-05-23   22     584.3194  0.308680 2020-05-01  0.665129</span>
<span class="go">3      01015 2020-05-23   22     122.5577  0.526590 2020-05-01  0.574713</span>
<span class="go">4      01031 2020-05-23   22     114.8318  0.347450 2020-05-01  0.408163</span>
</pre></div>
</div>
<p>Each row represents one observation in one county on one day. The county FIPS
code is given in the <code class="docutils literal notranslate"><span class="pre">geo_value</span></code> column, the date in the <code class="docutils literal notranslate"><span class="pre">time_value</span></code>
column. Here <code class="docutils literal notranslate"><span class="pre">value</span></code> is the requested signal—in this case, the smoothed
estimate of the percentage of people with COVID-like illness, based on the
symptom surveys. <code class="docutils literal notranslate"><span class="pre">stderr</span></code> is its standard error. The <code class="docutils literal notranslate"><span class="pre">issue</span></code> column
indicates when this data was reported; in this case, the survey estimates for
May 1st were updated on May 23rd based on new data, giving a <code class="docutils literal notranslate"><span class="pre">lag</span></code> of 22 days.
See the <a class="reference internal" href="signals.html#covidcast.signal" title="covidcast.signal"><code class="xref py py-func docutils literal notranslate"><span class="pre">covidcast.signal()</span></code></a> documentation for details on the returned
data frame.</p>
<p>The API documentation lists each available signal and provides technical details
on how it is estimated and how its standard error is calculated. In this case,
for example, the <a class="reference external" href="https://cmu-delphi.github.io/delphi-epidata/api/covidcast-signals/fb-survey.html">symptom surveys documentation page</a>
explains the definition of “COVID-like illness”, links to the exact survey text,
and describes the mathematical derivation of the estimates.</p>
<p>We can also request all data on a signal after a specific date. Here, for
example, we obtain <code class="docutils literal notranslate"><span class="pre">smoothed_cli</span></code> in each state for every day since
2020-05-01:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">covidcast</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="s2">&quot;fb-survey&quot;</span><span class="p">,</span> <span class="s2">&quot;smoothed_cli&quot;</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">geo_type</span><span class="o">=</span><span class="s2">&quot;state&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">   geo_value      issue  lag  sample_size    stderr time_value     value</span>
<span class="go">0         ak 2020-05-23   22    1606.0000  0.158880 2020-05-01  0.460772</span>
<span class="go">1         al 2020-05-23   22    7540.2437  0.082553 2020-05-01  0.699511</span>
<span class="go">2         ar 2020-05-23   22    4921.4827  0.103651 2020-05-01  0.759798</span>
<span class="go">3         az 2020-05-23   22   11220.9587  0.061794 2020-05-01  0.566937</span>
<span class="go">4         ca 2020-05-23   22   51870.1382  0.022803 2020-05-01  0.364908</span>
</pre></div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">geo_values</span></code> argument, we can request data for a specific geography,
such as the state of Pennsylvania for the month of May 2020:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pa_data</span> <span class="o">=</span> <span class="n">covidcast</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="s2">&quot;fb-survey&quot;</span><span class="p">,</span> <span class="s2">&quot;smoothed_cli&quot;</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="n">geo_type</span><span class="o">=</span><span class="s2">&quot;state&quot;</span><span class="p">,</span> <span class="n">geo_values</span><span class="o">=</span><span class="s2">&quot;pa&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pa_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">   geo_value      issue  lag  sample_size    stderr time_value     value</span>
<span class="go">0         pa 2020-05-23   22   31576.0165  0.030764 2020-05-01  0.400011</span>
<span class="go">0         pa 2020-05-23   21   31344.0168  0.030708 2020-05-02  0.394774</span>
<span class="go">0         pa 2020-05-23   20   30620.0162  0.031173 2020-05-03  0.396340</span>
<span class="go">0         pa 2020-05-23   19   30419.0163  0.029836 2020-05-04  0.357501</span>
<span class="go">0         pa 2020-05-23   18   29245.0172  0.030176 2020-05-05  0.354521</span>
</pre></div>
</div>
<p>We can request multiple states by providing a list, such as <code class="docutils literal notranslate"><span class="pre">[&quot;pa&quot;,</span> <span class="pre">&quot;ny&quot;,</span>
<span class="pre">&quot;mo&quot;]</span></code>.</p>
<p>Sometimes it may be useful to join multiple signals into a single data frame.
For example, suppose I’d like to look at the relationships between cases at each
location and the number of deaths three days later. The
<a class="reference internal" href="signals.html#covidcast.aggregate_signals" title="covidcast.aggregate_signals"><code class="xref py py-func docutils literal notranslate"><span class="pre">covidcast.aggregate_signals()</span></code></a> function can combine multiple data frames
into a single one, optionally with lag. In this case, I use it as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cases</span> <span class="o">=</span> <span class="n">covidcast</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="s2">&quot;indicator-combination&quot;</span><span class="p">,</span> <span class="s2">&quot;confirmed_incidence_num&quot;</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="n">geo_type</span><span class="o">=</span><span class="s2">&quot;state&quot;</span><span class="p">,</span> <span class="n">geo_values</span><span class="o">=</span><span class="s2">&quot;pa&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">deaths</span> <span class="o">=</span> <span class="n">covidcast</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="s2">&quot;indicator-combination&quot;</span><span class="p">,</span> <span class="s2">&quot;deaths_incidence_num&quot;</span><span class="p">,</span>
<span class="gp">... </span>                          <span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">31</span><span class="p">),</span>
<span class="gp">... </span>                          <span class="n">geo_type</span><span class="o">=</span><span class="s2">&quot;state&quot;</span><span class="p">,</span> <span class="n">geo_values</span><span class="o">=</span><span class="s2">&quot;pa&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cases_v_deaths</span> <span class="o">=</span> <span class="n">covidcast</span><span class="o">.</span><span class="n">aggregate_signals</span><span class="p">([</span><span class="n">cases</span><span class="p">,</span> <span class="n">deaths</span><span class="p">],</span> <span class="n">dt</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cases_v_deaths</span> <span class="o">=</span> <span class="n">cases_v_deaths</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;indicator-combination_confirmed_incidence_num_0_value&quot;</span><span class="p">:</span> <span class="s2">&quot;cases&quot;</span><span class="p">,</span>
<span class="gp">... </span>             <span class="s2">&quot;indicator-combination_deaths_incidence_num_1_value&quot;</span><span class="p">:</span> <span class="s2">&quot;deaths&quot;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cases_v_deaths</span><span class="p">[[</span><span class="s2">&quot;time_value&quot;</span><span class="p">,</span> <span class="s2">&quot;geo_value&quot;</span><span class="p">,</span> <span class="s2">&quot;cases&quot;</span><span class="p">,</span> <span class="s2">&quot;deaths&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">  time_value geo_value   cases  deaths</span>
<span class="go">0 2020-05-01        pa     NaN    62.0</span>
<span class="go">1 2020-05-02        pa     NaN    65.0</span>
<span class="go">2 2020-05-03        pa     NaN    24.0</span>
<span class="go">3 2020-05-04        pa  1209.0    13.0</span>
<span class="go">4 2020-05-05        pa  1332.0   547.0</span>
</pre></div>
</div>
<p>The resulting <code class="docutils literal notranslate"><span class="pre">cases_v_deaths</span></code> data frame contains one row per location per
day. The death value is the number of deaths on that day; the cases value is the
number of cases <em>3 days prior</em>, matching the <code class="docutils literal notranslate"><span class="pre">dt</span></code> provided to
<a class="reference internal" href="signals.html#covidcast.aggregate_signals" title="covidcast.aggregate_signals"><code class="xref py py-func docutils literal notranslate"><span class="pre">covidcast.aggregate_signals()</span></code></a>. The first three case values shown above
are <code class="docutils literal notranslate"><span class="pre">NaN</span></code> because the input data frame did not contain case numbers for late
April.</p>
<p>Note the long column names used by default to prevent ambiguity or name
collisions.</p>
</div>
<div class="section" id="tracking-issues-and-updates">
<h2>Tracking issues and updates<a class="headerlink" href="#tracking-issues-and-updates" title="Permalink to this headline">¶</a></h2>
<p>The COVIDcast API records not just each signal’s estimate for a given location
on a given day, but also <em>when</em> that estimate was made, and all updates to that
estimate.</p>
<p>For example, consider using our <a class="reference external" href="https://cmu-delphi.github.io/delphi-epidata/api/covidcast-signals/doctor-visits.html">doctor visits signal</a>,
which estimates the percentage of outpatient doctor visits that are
COVID-related, and consider a result row with <code class="docutils literal notranslate"><span class="pre">time_value</span></code> 2020-05-01 for
<code class="docutils literal notranslate"><span class="pre">geo_values</span> <span class="pre">=</span> <span class="pre">&quot;pa&quot;</span></code>. This is an estimate for the percentage in Pennsylvania on
May 1, 2020. That estimate was <em>issued</em> on May 5, 2020, the delay being due to
the aggregation of data by our source and the time taken by the COVIDcast API to
ingest the data provided. Later, the estimate for May 1st could be updated,
perhaps because additional visit data from May 1st arrived at our source and was
reported to us. This constitutes a new <em>issue</em> of the data.</p>
<p>By default, <a class="reference internal" href="signals.html#covidcast.signal" title="covidcast.signal"><code class="xref py py-func docutils literal notranslate"><span class="pre">covidcast.signal()</span></code></a> fetches the most recent issue available.
This is the best option for users who simply want to graph the latest data or
construct dashboards. But if we are interested in knowing <em>when</em> data was
reported, we can request specific data versions.</p>
<p>First, we can request the data that was available <em>as of</em> a specific date, using
the <code class="docutils literal notranslate"><span class="pre">as_of</span></code> argument:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">covidcast</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="s2">&quot;doctor-visits&quot;</span><span class="p">,</span> <span class="s2">&quot;smoothed_cli&quot;</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">start_day</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">end_day</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>                 <span class="n">geo_type</span><span class="o">=</span><span class="s2">&quot;state&quot;</span><span class="p">,</span> <span class="n">geo_values</span><span class="o">=</span><span class="s2">&quot;pa&quot;</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">as_of</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="go">   geo_value      issue  lag sample_size stderr time_value    value</span>
<span class="go">0         pa 2020-05-07    6        None   None 2020-05-01  2.32192</span>
</pre></div>
</div>
<p>This shows that an estimate of about 2.3% was issued on May 7. If we don’t
specify <code class="docutils literal notranslate"><span class="pre">as_of</span></code>, we get the most recent estimate available:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">covidcast</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="s2">&quot;doctor-visits&quot;</span><span class="p">,</span> <span class="s2">&quot;smoothed_cli&quot;</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">start_day</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">end_day</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>                 <span class="n">geo_type</span><span class="o">=</span><span class="s2">&quot;state&quot;</span><span class="p">,</span> <span class="n">geo_values</span><span class="o">=</span><span class="s2">&quot;pa&quot;</span><span class="p">)</span>
<span class="go">   geo_value      issue  lag sample_size stderr time_value     value</span>
<span class="go">0         pa 2020-07-04   64        None   None 2020-05-01  5.075015</span>
</pre></div>
</div>
<p>Note the substantial change in the estimate, to over 5%, reflecting new data
that became available <em>after</em> May 7 about visits occurring on May 1. This
illustrates the importance of issue date tracking, particularly for forecasting
tasks. To backtest a forecasting model on past data, it is important to use the
data that would have been available <em>at the time</em>, not data that arrived much
later.</p>
<p>By using the <code class="docutils literal notranslate"><span class="pre">issues</span></code> argument, we can request all issues in a certain time
period:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">covidcast</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="s2">&quot;doctor-visits&quot;</span><span class="p">,</span> <span class="s2">&quot;smoothed_cli&quot;</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">start_day</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">end_day</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>                 <span class="n">geo_type</span><span class="o">=</span><span class="s2">&quot;state&quot;</span><span class="p">,</span> <span class="n">geo_values</span><span class="o">=</span><span class="s2">&quot;pa&quot;</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">issues</span><span class="o">=</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">)))</span>
<span class="go">   geo_value      issue  lag sample_size stderr time_value     value</span>
<span class="go">0         pa 2020-05-05    4        None   None 2020-05-01  1.693061</span>
<span class="go">1         pa 2020-05-06    5        None   None 2020-05-01  2.524167</span>
<span class="go">2         pa 2020-05-07    6        None   None 2020-05-01  2.321920</span>
<span class="go">3         pa 2020-05-08    7        None   None 2020-05-01  2.897032</span>
<span class="go">4         pa 2020-05-09    8        None   None 2020-05-01  2.956456</span>
<span class="go">5         pa 2020-05-12   11        None   None 2020-05-01  3.190634</span>
<span class="go">6         pa 2020-05-13   12        None   None 2020-05-01  3.220023</span>
<span class="go">7         pa 2020-05-14   13        None   None 2020-05-01  3.231314</span>
<span class="go">8         pa 2020-05-15   14        None   None 2020-05-01  3.239970</span>
</pre></div>
</div>
<p>This estimate was clearly updated many times as new data for May 1st arrived.
Note that these results include only data issued or updated between 2020-05-01
and 2020-05-15. If a value was first reported on 2020-04-15, and never updated,
a query for issues between 2020-05-01 and 2020-05-15 will not include that value
among its results.</p>
<p>Finally, we can use the <code class="docutils literal notranslate"><span class="pre">lag</span></code> argument to request only data reported with a
certain lag. For example, requesting a lag of 7 days means to request only
issues 7 days after the corresponding <code class="docutils literal notranslate"><span class="pre">time_value</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">covidcast</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="s2">&quot;doctor-visits&quot;</span><span class="p">,</span> <span class="s2">&quot;smoothed_cli&quot;</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">start_day</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">end_day</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
<span class="gp">... </span>                 <span class="n">geo_type</span><span class="o">=</span><span class="s2">&quot;state&quot;</span><span class="p">,</span> <span class="n">geo_values</span><span class="o">=</span><span class="s2">&quot;pa&quot;</span><span class="p">,</span> <span class="n">lag</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="go">   geo_value      issue  lag sample_size stderr time_value     value</span>
<span class="go">0         pa 2020-05-08    7        None   None 2020-05-01  2.897032</span>
<span class="go">0         pa 2020-05-09    7        None   None 2020-05-02  2.802238</span>
<span class="go">0         pa 2020-05-12    7        None   None 2020-05-05  3.483125</span>
<span class="go">0         pa 2020-05-13    7        None   None 2020-05-06  2.968670</span>
<span class="go">0         pa 2020-05-14    7        None   None 2020-05-07  2.400255</span>
</pre></div>
</div>
<p>Note that though this query requested all values between 2020-05-01 and
2020-05-07, May 3rd and May 4th were <em>not</em> included in the results set. This is
because the query will only include a result for May 3rd if a value were issued
on May 10th (a 7-day lag), but in fact the value was not updated on that day:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">covidcast</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="s2">&quot;doctor-visits&quot;</span><span class="p">,</span> <span class="s2">&quot;smoothed_cli&quot;</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">start_day</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">end_day</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<span class="gp">... </span>                 <span class="n">geo_type</span><span class="o">=</span><span class="s2">&quot;state&quot;</span><span class="p">,</span> <span class="n">geo_values</span><span class="o">=</span><span class="s2">&quot;pa&quot;</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">issues</span><span class="o">=</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">)))</span>
<span class="go">   geo_value      issue  lag sample_size stderr time_value     value</span>
<span class="go">0         pa 2020-05-09    6        None   None 2020-05-03  2.749537</span>
<span class="go">1         pa 2020-05-12    9        None   None 2020-05-03  2.989626</span>
<span class="go">2         pa 2020-05-13   10        None   None 2020-05-03  3.006860</span>
<span class="go">3         pa 2020-05-14   11        None   None 2020-05-03  2.970561</span>
<span class="go">4         pa 2020-05-15   12        None   None 2020-05-03  3.038054</span>
</pre></div>
</div>
</div>
<div class="section" id="dealing-with-geographies">
<h2>Dealing with geographies<a class="headerlink" href="#dealing-with-geographies" title="Permalink to this headline">¶</a></h2>
<p>As seen above, the COVIDcast API identifies counties by their FIPS code and
states by two-letter abbreviations. Metropolitan statistical areas are also
identified by unique codes, called CBSA IDs. (Exact details and exceptions are
given in the <a class="reference external" href="https://cmu-delphi.github.io/delphi-epidata/api/covidcast_geography.html">geographic coding documentation</a>.) If
you want to find a specific area by name, this package provides convenience
functions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">covidcast</span><span class="o">.</span><span class="n">name_to_cbsa</span><span class="p">([</span><span class="s2">&quot;Houston&quot;</span><span class="p">,</span> <span class="s2">&quot;San Antonio&quot;</span><span class="p">])</span>
<span class="go">[&#39;26420&#39;, &#39;41700&#39;]</span>
</pre></div>
</div>
<p>We can use these functions to quickly query data for specific regions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">counties</span> <span class="o">=</span> <span class="n">covidcast</span><span class="o">.</span><span class="n">name_to_fips</span><span class="p">([</span><span class="s2">&quot;Allegheny&quot;</span><span class="p">,</span> <span class="s2">&quot;Los Angeles&quot;</span><span class="p">,</span> <span class="s2">&quot;Miami-Dade&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">covidcast</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="s2">&quot;doctor-visits&quot;</span><span class="p">,</span> <span class="s2">&quot;smoothed_cli&quot;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">start_day</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">end_day</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>                      <span class="n">geo_values</span><span class="o">=</span><span class="n">counties</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span>
<span class="go">  geo_value        signal time_value      issue  lag     value stderr sample_size geo_type    data_source</span>
<span class="go">0     42003  smoothed_cli 2020-05-01 2020-07-04   64  1.336086   None        None   county  doctor-visits</span>
<span class="go">0     06037  smoothed_cli 2020-05-01 2020-07-04   64  5.787655   None        None   county  doctor-visits</span>
<span class="go">0     12086  smoothed_cli 2020-05-01 2020-07-04   64  6.405477   None        None   county  doctor-visits</span>
</pre></div>
</div>
<p>We can also quickly convert back from the IDs returned by the API to
human-readable names:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">covidcast</span><span class="o">.</span><span class="n">fips_to_name</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">geo_value</span><span class="p">)</span>
<span class="go">[&#39;Allegheny County&#39;, &#39;Los Angeles County&#39;, &#39;Miami-Dade County&#39;]</span>
</pre></div>
</div>
<p>Because the functions support regular expression matching, we can quickly find
all regions meeting certain criteria. For example, the five-digit FIPS codes
used to identify counties use their first two digits to identify the state. We
can find all counties in the state of Pennsylvania by querying for FIPS codes
beginning with 42 and requesting all matches:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pa_counties</span> <span class="o">=</span> <span class="n">covidcast</span><span class="o">.</span><span class="n">fips_to_name</span><span class="p">(</span><span class="s2">&quot;^42.*&quot;</span><span class="p">,</span> <span class="n">ties_method</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pa_counties</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{&#39;42000&#39;: [&#39;Pennsylvania&#39;], &#39;42001&#39;: [&#39;Adams County&#39;], &#39;42003&#39;: [&#39;Allegheny County&#39;], &#39;42005&#39;: [&#39;Armstrong County&#39;], &#39;42007&#39;: [&#39;Beaver County&#39;], &#39;42009&#39;: [&#39;Bedford County&#39;], &#39;42011&#39;: [&#39;Berks County&#39;], &#39;42013&#39;: [&#39;Blair County&#39;], &#39;42015&#39;: [&#39;Bradford County&#39;], &#39;42017&#39;: [&#39;Bucks County&#39;], &#39;42019&#39;: [&#39;Butler County&#39;], &#39;42021&#39;: [&#39;Cambria County&#39;], &#39;42023&#39;: [&#39;Cameron County&#39;], &#39;42025&#39;: [&#39;Carbon County&#39;], &#39;42027&#39;: [&#39;Centre County&#39;], &#39;42029&#39;: [&#39;Chester County&#39;], &#39;42031&#39;: [&#39;Clarion County&#39;], &#39;42033&#39;: [&#39;Clearfield County&#39;], &#39;42035&#39;: [&#39;Clinton County&#39;], &#39;42037&#39;: [&#39;Columbia County&#39;], &#39;42039&#39;: [&#39;Crawford County&#39;], &#39;42041&#39;: [&#39;Cumberland County&#39;], &#39;42043&#39;: [&#39;Dauphin County&#39;], &#39;42045&#39;: [&#39;Delaware County&#39;], &#39;42047&#39;: [&#39;Elk County&#39;], &#39;42049&#39;: [&#39;Erie County&#39;], &#39;42051&#39;: [&#39;Fayette County&#39;], &#39;42053&#39;: [&#39;Forest County&#39;], &#39;42055&#39;: [&#39;Franklin County&#39;], &#39;42057&#39;: [&#39;Fulton County&#39;], &#39;42059&#39;: [&#39;Greene County&#39;], &#39;42061&#39;: [&#39;Huntingdon County&#39;], &#39;42063&#39;: [&#39;Indiana County&#39;], &#39;42065&#39;: [&#39;Jefferson County&#39;], &#39;42067&#39;: [&#39;Juniata County&#39;], &#39;42069&#39;: [&#39;Lackawanna County&#39;], &#39;42071&#39;: [&#39;Lancaster County&#39;], &#39;42073&#39;: [&#39;Lawrence County&#39;], &#39;42075&#39;: [&#39;Lebanon County&#39;], &#39;42077&#39;: [&#39;Lehigh County&#39;], &#39;42079&#39;: [&#39;Luzerne County&#39;], &#39;42081&#39;: [&#39;Lycoming County&#39;], &#39;42083&#39;: [&#39;McKean County&#39;], &#39;42085&#39;: [&#39;Mercer County&#39;], &#39;42087&#39;: [&#39;Mifflin County&#39;], &#39;42089&#39;: [&#39;Monroe County&#39;], &#39;42091&#39;: [&#39;Montgomery County&#39;], &#39;42093&#39;: [&#39;Montour County&#39;], &#39;42095&#39;: [&#39;Northampton County&#39;], &#39;42097&#39;: [&#39;Northumberland County&#39;], &#39;42099&#39;: [&#39;Perry County&#39;], &#39;42101&#39;: [&#39;Philadelphia County&#39;], &#39;42103&#39;: [&#39;Pike County&#39;], &#39;42105&#39;: [&#39;Potter County&#39;], &#39;42107&#39;: [&#39;Schuylkill County&#39;], &#39;42109&#39;: [&#39;Snyder County&#39;], &#39;42111&#39;: [&#39;Somerset County&#39;], &#39;42113&#39;: [&#39;Sullivan County&#39;], &#39;42115&#39;: [&#39;Susquehanna County&#39;], &#39;42117&#39;: [&#39;Tioga County&#39;], &#39;42119&#39;: [&#39;Union County&#39;], &#39;42121&#39;: [&#39;Venango County&#39;], &#39;42123&#39;: [&#39;Warren County&#39;], &#39;42125&#39;: [&#39;Washington County&#39;], &#39;42127&#39;: [&#39;Wayne County&#39;], &#39;42129&#39;: [&#39;Westmoreland County&#39;], &#39;42131&#39;: [&#39;Wyoming County&#39;], &#39;42133&#39;: [&#39;York County&#39;]}</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="signals.html#working-with-geos"><span class="std std-ref">Working with geographic identifiers</span></a> for details on each of these functions and their
optional arguments.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">COVIDcast API client</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#signal-overview">Signal Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-examples">Basic examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tracking-issues-and-updates">Tracking issues and updates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dealing-with-geographies">Dealing with geographies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="signals.html">Fetching Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot_examples.html">Plotting Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">Plotting Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://delphi.cmu.edu/">Delphi group</a></li>
    
    <li class="toctree-l1"><a href="https://covidcast.cmu.edu/">COVIDcast maps</a></li>
    
    <li class="toctree-l1"><a href="https://cmu-delphi.github.io/delphi-epidata/api/covidcast.html">COVIDcast API</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">COVIDcast API client</a></li>
      <li>Next: <a href="signals.html" title="next chapter">Fetching Data</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Delphi research group.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.5.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/getting_started.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>